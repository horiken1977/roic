# ROIC計算仕様書

## 1. ROIC計算式の定義

### 1.1 基本計算式
```
ROIC = 投下資本回転率 × 営業利益率
```

### 1.2 構成要素の詳細

#### 1.2.1 投下資本回転率
```
投下資本回転率 = 売上高 ÷ 投下資本
投下資本 = 売上債権 + 棚卸資産 + 仕入債務 + 固定資産
```

#### 1.2.2 営業利益率
```
営業利益率 = 営業利益 ÷ 売上高
```

## 2. 比較表での表示形式

### 2.1 ROIC分解式
```
ROIC = 営業利益率（粗利率 - 販管費率）× 資本回転率（運転資本回転率 - 固定資産回転率）
```

### 2.2 各指標の計算式

#### 2.2.1 営業利益率の分解
- **粗利率** = 売上総利益 ÷ 売上高
- **販管費率** = 販売費及び一般管理費 ÷ 売上高
- **営業利益率** = 粗利率 - 販管費率

#### 2.2.2 資本回転率の分解
- **運転資本回転率** = 売上高 ÷ 運転資本
  - 運転資本 = 売上債権 + 棚卸資産 - 仕入債務
- **固定資産回転率** = 売上高 ÷ 固定資産

## 3. 財務データ項目の定義

### 3.1 貸借対照表（B/S）項目
| 項目名 | EDINETタグ名（参考） | 説明 |
|--------|---------------------|------|
| 売上債権 | TradeNotesAndAccountsReceivable | 受取手形及び売掛金 |
| 棚卸資産 | Inventories | 商品及び製品、仕掛品、原材料及び貯蔵品の合計 |
| 仕入債務 | TradeNotesAndAccountsPayable | 支払手形及び買掛金 |
| 固定資産 | PropertyPlantAndEquipment | 有形固定資産の合計 |

### 3.2 損益計算書（P/L）項目
| 項目名 | EDINETタグ名（参考） | 説明 |
|--------|---------------------|------|
| 売上高 | NetSales | 営業収益、売上高 |
| 売上総利益 | GrossProfit | 売上高 - 売上原価 |
| 販売費及び一般管理費 | SellingGeneralAndAdministrativeExpenses | 販管費の合計 |
| 営業利益 | OperatingIncome | 売上総利益 - 販管費 |

## 4. 計算例

### 4.1 サンプル企業データ
```
売上高: 1,000億円
営業利益: 100億円
売上債権: 150億円
棚卸資産: 80億円
仕入債務: 120億円
固定資産: 200億円
売上総利益: 300億円
販管費: 200億円
```

### 4.2 計算過程
1. **投下資本** = 150 + 80 + 120 + 200 = 550億円
2. **投下資本回転率** = 1,000 ÷ 550 = 1.82回
3. **営業利益率** = 100 ÷ 1,000 = 10%
4. **ROIC** = 1.82 × 10% = 18.2%

### 4.3 比較表での表示
- **粗利率** = 300 ÷ 1,000 = 30%
- **販管費率** = 200 ÷ 1,000 = 20%
- **営業利益率** = 30% - 20% = 10%
- **運転資本** = 150 + 80 - 120 = 110億円
- **運転資本回転率** = 1,000 ÷ 110 = 9.09回
- **固定資産回転率** = 1,000 ÷ 200 = 5.00回

## 5. 実装上の注意点

### 5.1 データ取得時の考慮事項
- 連結財務諸表を優先的に使用
- 会計基準の違い（日本基準、IFRS）に注意
- 決算期の違いを考慮した比較

### 5.2 エラーハンドリング
- ゼロ除算の回避
- データ欠損時の処理
- 異常値の検出とアラート

### 5.3 表示上の工夫
- パーセント表示は小数点第1位まで
- 金額は億円単位で表示
- マイナス値は赤字表示
- 前年比較機能の実装