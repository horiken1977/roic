(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{7789:(e,a,s)=>{"use strict";s.d(a,{default:()=>n});var t=s(5155),l=s(2115);function n(){let[e,a]=(0,l.useState)({unit:{passed:0,failed:0,total:0,coverage:0,lastRun:null},e2e:{passed:0,failed:0,total:0,lastRun:null},integration:{passed:0,failed:0,total:0,lastRun:null},performance:{passed:0,failed:0,total:0,lastRun:null},security:{passed:0,failed:0,total:0,lastRun:null},build:{status:"unknown",lastRun:null},deployment:{status:"unknown",lastRun:null}}),[s,n]=(0,l.useState)(!1),[r,d]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=null,s=()=>{try{(e=new WebSocket("ws://localhost:3002")).onopen=()=>{console.log("Test progress WebSocket connected"),n(!0)},e.onmessage=e=>{try{let s=JSON.parse(e.data);switch(s.type){case"initial-data":a(s.data),d(new Date);break;case"unit-test-results":a(e=>({...e,unit:s.data})),d(new Date);break;case"e2e-test-results":a(e=>({...e,e2e:s.data})),d(new Date);break;case"build-results":a(e=>({...e,build:s.data})),d(new Date);break;case"performance-test-results":a(e=>({...e,performance:s.data})),d(new Date);break;case"security-test-results":a(e=>({...e,security:s.data})),d(new Date);break;default:d(new Date)}}catch(e){console.error("Failed to parse WebSocket message:",e)}},e.onclose=()=>{console.log("Test progress WebSocket disconnected"),n(!1),setTimeout(s,5e3)},e.onerror=e=>{console.error("WebSocket error:",e),n(!1)}}catch(e){console.error("Failed to connect WebSocket:",e),n(!1),setTimeout(()=>{c()},1e4)}};return s(),()=>{e&&e.close()}},[]);let c=async()=>{try{let e=await fetch("/api/test-results");if(e.ok){let s=await e.json();a(s),d(new Date)}}catch(e){console.error("Failed to fetch test results:",e)}},i=(e,a)=>0===a?0:Math.round(e/a*100),o=(e,a,s)=>0===s?"bg-gray-200":a>0?"bg-red-500":"bg-green-500",u=(e,a,s)=>0===s?"⏳":a>0?"❌":"✅",m=e=>{if(!e)return"未実行";let a=new Date(e),s=Math.floor((new Date().getTime()-a.getTime())/6e4);return s<1?"たった今":s<60?"".concat(s,"分前"):s<1440?"".concat(Math.floor(s/60),"時間前"):a.toLocaleDateString("ja-JP")},x=[{name:"ユニットテスト",icon:"\uD83E\uDDEA",data:e.unit,showCoverage:!0},{name:"E2Eテスト",icon:"\uD83C\uDFAD",data:e.e2e,showCoverage:!1},{name:"パフォーマンス",icon:"⚡",data:e.performance,showCoverage:!1},{name:"セキュリティ",icon:"\uD83D\uDD12",data:e.security,showCoverage:!1}];return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"テスト進捗状況"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s?"bg-green-500":"bg-red-500"),title:s?"リアルタイム接続中":"接続なし"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:r?"更新: ".concat(m(r.toISOString())):"未更新"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map(e=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg",children:e.icon}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.name})]}),(0,t.jsx)("span",{className:"text-lg",children:u(e.data.passed,e.data.failed,e.data.total)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[e.data.passed,"/",e.data.total," 成功"]}),(0,t.jsxs)("span",{className:"text-gray-600",children:[i(e.data.passed,e.data.total),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(o(e.data.passed,e.data.failed,e.data.total)),style:{width:"".concat(i(e.data.passed,e.data.total),"%")}})}),e.showCoverage&&e.data.coverage>0&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["カバレッジ: ",e.data.coverage,"%"]}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:m(e.data.lastRun)})]})]},e.name))}),(0,t.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{children:"\uD83D\uDD27"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"ビルド"}),(0,t.jsx)("span",{className:"text-sm",children:"success"===e.build.status?"✅":"failed"===e.build.status?"❌":"⏳"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:m(e.build.lastRun)})]}),(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{children:"\uD83D\uDE80"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"デプロイメント"}),(0,t.jsx)("span",{className:"text-sm",children:"success"===e.deployment.status?"✅":"failed"===e.deployment.status?"❌":"⏳"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:m(e.deployment.lastRun)})]})]}),!s&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-yellow-600",children:"⚠️"}),(0,t.jsx)("span",{className:"text-sm text-yellow-800",children:"リアルタイム更新が無効です。手動で再読み込みしてください。"})]})})]})}},8230:(e,a,s)=>{Promise.resolve().then(s.t.bind(s,6874,23)),Promise.resolve().then(s.bind(s,7789))}},e=>{var a=a=>e(e.s=a);e.O(0,[874,441,684,358],()=>a(8230)),_N_E=e.O()}]);